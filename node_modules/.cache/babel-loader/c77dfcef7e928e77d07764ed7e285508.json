{"remainingRequest":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Brezgo-1098\\Desktop\\brezz\\src\\components\\app-video.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\src\\components\\app-video.vue","mtime":1587032502000},{"path":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Brezgo-1098\\Desktop\\brezz\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzpcXFVzZXJzXFxCcmV6Z28tMTA5OFxcRGVza3RvcFxcYnJlenpcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIGxvZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2FwcDphcHAtcGVlcicpOwoKZnVuY3Rpb24gY29ubmVjdFN0cmVhbVRvVmlkZW9FbGVtZW50KF94LCBfeDIpIHsKICByZXR1cm4gX2Nvbm5lY3RTdHJlYW1Ub1ZpZGVvRWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfY29ubmVjdFN0cmVhbVRvVmlkZW9FbGVtZW50KCkgewogIF9jb25uZWN0U3RyZWFtVG9WaWRlb0VsZW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKHN0cmVhbSwgdmlkZW8pIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGxvZygnY29ubmVjdFN0cmVhbVRvVmlkZW9FbGVtZW50Jywgc3RyZWFtLCB2aWRlbyk7CgogICAgICAgICAgICBpZiAoc3RyZWFtKSB7CiAgICAgICAgICAgICAgaWYgKCdzcmNPYmplY3QnIGluIHZpZGVvKSB7CiAgICAgICAgICAgICAgICB2aWRlby5zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZpZGVvLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7IC8vIGZvciBvbGRlciBicm93c2VycwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmlkZW8ub25sb2FkZWRtZXRhZGF0YSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB2aWRlby5wbGF5KCk7CiAgICAgICAgICAgICAgfTsgLy8gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgIC8vICAgdHJ5IHsKICAgICAgICAgICAgICAvLyAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHZpZGVvLnBsYXkoKQogICAgICAgICAgICAgIC8vICAgICBsb2coJ3BsYXkgb2snLCByZXN1bHQpCiAgICAgICAgICAgICAgLy8gICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAvLyAgICAgbG9nKCdwbGF5IGVycm9yJywgZXJyKQogICAgICAgICAgICAgIC8vICAgfQogICAgICAgICAgICAgIC8vIH0sIDEwMDApCgogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMyk7CiAgfSkpOwogIHJldHVybiBfY29ubmVjdFN0cmVhbVRvVmlkZW9FbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnYXBwLXZpZGVvJywKICBwcm9wczogewogICAgc3RyZWFtOiB7CiAgICAgIHR5cGU6IE1lZGlhU3RyZWFtIHwgT2JqZWN0LAogICAgICAiZGVmYXVsdCI6IG51bGwKICAgIH0sCiAgICBhY3RpdmU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgImRlZmF1bHQiOiBmYWxzZQogICAgfSwKICAgIG11dGVkOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICJkZWZhdWx0IjogZmFsc2UKICAgIH0sCiAgICB0aXRsZTogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBtaXJyb3JlZDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICAiZGVmYXVsdCI6IGZhbHNlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHt9OwogIH0sCiAgbWV0aG9kczogewogICAgZG9Db25uZWN0U3RyZWFtOiBmdW5jdGlvbiBkb0Nvbm5lY3RTdHJlYW0oc3RyZWFtKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGxvZygnZG9Db25uZWN0U3RyZWFtJywgX3RoaXMudGl0bGUsIHN0cmVhbSk7CgogICAgICAgICAgICAgICAgaWYgKCFzdHJlYW0pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRuZXh0VGljaygpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiBjb25uZWN0U3RyZWFtVG9WaWRlb0VsZW1lbnQoc3RyZWFtLCBfdGhpcy4kcmVmcy52aWRlbyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5kb0Nvbm5lY3RTdHJlYW0oX3RoaXMyLnN0cmVhbSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSkoKTsKICB9LAogIHdhdGNoOiB7CiAgICBzdHJlYW06IGZ1bmN0aW9uIHN0cmVhbSh2YWx1ZSkgewogICAgICB0aGlzLmRvQ29ubmVjdFN0cmVhbSh2YWx1ZSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["app-video.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAkBA,IAAA,GAAA,GAAA,OAAA,CAAA,OAAA,CAAA,CAAA,cAAA,CAAA;;SAEA,2B;;;;;yFAAA,kBAAA,MAAA,EAAA,KAAA;AAAA;AAAA;AAAA;AAAA;AACA,YAAA,GAAA,CAAA,6BAAA,EAAA,MAAA,EAAA,KAAA,CAAA;;AACA,gBAAA,MAAA,EAAA;AACA,kBAAA,eAAA,KAAA,EAAA;AACA,gBAAA,KAAA,CAAA,SAAA,GAAA,MAAA;AACA,eAFA,MAEA;AACA,gBAAA,KAAA,CAAA,GAAA,GAAA,MAAA,CAAA,GAAA,CAAA,eAAA,CAAA,MAAA,CAAA,CADA,CACA;AACA;;AACA,cAAA,KAAA,CAAA,gBAAA,GAAA,UAAA,CAAA,EAAA;AACA,gBAAA,KAAA,CAAA,IAAA;AACA,eAFA,CANA,CASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;;AAnBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAsBA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAGA,EAAA,KAAA,EAAA;AACA,IAAA,MAAA,EAAA;AACA,MAAA,IAAA,EAAA,WAAA,GAAA,MADA;AAEA,iBAAA;AAFA,KADA;AAKA,IAAA,MAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,iBAAA;AAFA,KALA;AASA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,iBAAA;AAFA,KATA;AAaA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA;AADA,KAbA;AAgBA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,iBAAA;AAFA;AAhBA,GAHA;AAwBA,EAAA,IAxBA,kBAwBA;AACA,WAAA,EAAA;AACA,GA1BA;AA2BA,EAAA,OAAA,EAAA;AACA,IAAA,eADA,2BACA,MADA,EACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,GAAA,CAAA,iBAAA,EAAA,KAAA,CAAA,KAAA,EAAA,MAAA,CAAA;;AADA,qBAEA,MAFA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAGA,KAAA,CAAA,SAAA,EAHA;;AAAA;AAAA;AAAA,uBAIA,2BAAA,CAAA,MAAA,EAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAJA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AATA,GA3BA;AAsCA,EAAA,OAtCA,qBAsCA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAKA,MAAA,CAAA,eAAA,CAAA,MAAA,CAAA,MAAA,CALA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,GA5CA;AA6CA,EAAA,KAAA,EAAA;AACA,IAAA,MADA,kBACA,KADA,EACA;AACA,WAAA,eAAA,CAAA,KAAA;AACA;AAHA;AA7CA,CAAA","sourcesContent":["<template>\n  <div class=\"peer item\">\n    <video\n      class=\"video\"\n      ref=\"video\"\n      autoplay\n      playsinline\n      :muted=\"muted\"\n      v-if=\"stream\"\n      :class=\"{'-mirrored': mirrored}\"\n    />\n    <div v-else class=\"video video-placeholder -content-placeholder\">\n      <i data-f7-icon=\"rectangle_stack_person_crop\"></i>\n    </div>\n  </div>\n</template>\n\n<script>\nconst log = require('debug')('app:app-peer')\n\nasync function connectStreamToVideoElement(stream, video) {\n  log('connectStreamToVideoElement', stream, video)\n  if (stream) {\n    if ('srcObject' in video) {\n      video.srcObject = stream\n    } else {\n      video.src = window.URL.createObjectURL(stream) // for older browsers\n    }\n    video.onloadedmetadata = function (e) {\n      video.play()\n    }\n    // setInterval(async () => {\n    //   try {\n    //     let result = await video.play()\n    //     log('play ok', result)\n    //   } catch (err) {\n    //     log('play error', err)\n    //   }\n    // }, 1000)\n  }\n}\n\nexport default {\n  name: 'app-video',\n\n  props: {\n    stream: {\n      type: MediaStream | Object,\n      default: null,\n    },\n    active: {\n      type: Boolean,\n      default: false,\n    },\n    muted: {\n      type: Boolean,\n      default: false,\n    },\n    title: {\n      type: String,\n    },\n    mirrored: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {}\n  },\n  methods: {\n    async doConnectStream(stream) {\n      log('doConnectStream', this.title, stream)\n      if (stream) {\n        await this.$nextTick()\n        await connectStreamToVideoElement(stream, this.$refs.video)\n        // stream.onaddtrack = async () => await connectStreamToVideoElement(stream, this.$refs.video)\n        // stream.onremovetrack = async () => await connectStreamToVideoElement(stream, this.$refs.video)\n      }\n    },\n  },\n  async mounted() {\n    // webrtc.on('stream', async () => {\n    //   await this.$nextTick()\n    //   await this.doConnectStream(this.stream)\n    // })\n    await this.doConnectStream(this.stream)\n  },\n  watch: {\n    stream(value) {\n      this.doConnectStream(value)\n    },\n  },\n}\n</script>\n\n"],"sourceRoot":"src/components"}]}